#!/bin/sh

#
# to generate a list of certificates, add the server name in the list below
# and run ./GO-mac
#
# If you have a real certificate for your server, place it in the folder
# No need to generate one:
#      127.0.0.1.crt
#      127.0.0.1.key
# Wildcard certificates:
#      _.evl.uic.edu.crt
#      _.evl.uic.edu.key


servers="$HOSTNAME localhost 127.0.0.1"

for f in `echo $servers`
do
	./init_webserver.cmd $f
done

/usr/bin/security add-trusted-cert -d -r trustRoot localhost-server.crt

openssl x509 -in localhost-ca.crt -pubkey -noout | openssl rsa -pubin -outform der | openssl dgst -sha256 -binary | openssl enc -base64 > pin1.sha256
openssl x509 -in 127.0.0.1-ca.crt -pubkey -noout | openssl rsa -pubin -outform der | openssl dgst -sha256 -binary | openssl enc -base64 > pin2.sha256
