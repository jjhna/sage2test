<!DOCTYPE html>
<html>
<head lang="en">
<meta charset="utf-,8">
<title>SAGE2 site index</title>

<script type="text/javascript">
	// SAGE2 is available for use under the SAGE2 Software License
	//
	// University of Illinois at Chicago's Electronic Visualization Laboratory (EVL)
	// and University of Hawai'i at Manoa's Laboratory for Advanced Visualization and
	// Applications (LAVA)
	//
	// See full text, terms and conditions in the LICENSE.txt included file
	//
	// Copyright (c) 2014
</script>

<script type="text/javascript">
	var json_cfg;
	var hostname;
	var port;
	
	function init() {
		hostname = window.location.hostname;
		port = window.location.port;
		if(window.location.protocol == "http:" && port == "") port = "80";
		if(window.location.protocol == "https:" && port == "") port = "443";
	
		xhr = new XMLHttpRequest();
		xhr.open("GET", "/config", true);
		xhr.onreadystatechange = function() {
			if(xhr.readyState == 4 && xhr.status == 200){
				json_cfg = JSON.parse(xhr.responseText);
				console.log(json_cfg);
				
				initializePageList();
			}
		};
		xhr.send();
	}
	
	function initializePageList() {
		var userInteraction = document.getElementById('userInteraction');
		var audio       = document.getElementById('audio');
		var display     = document.getElementById('display');
		var information = document.getElementById('information');
		var remotesites = document.getElementById('remotesites');

		var https_port = ":" + json_cfg.port.toString();
		if (https_port == ":443") https_port = "";
		
		// User Interaction
		var sageUI = document.createElement('p');
		var sageUI_link = document.createElement('a');
		sageUI_link.textContent = "SAGE UI";
		if (json_cfg.public_host)
			sageUI_link.href = "https://" + json_cfg.public_host + https_port + "/sageUI.html";
		else
			sageUI_link.href = "https://" + json_cfg.host + https_port + "/sageUI.html";
		sageUI_link.target = "_blank";
		sageUI.appendChild(sageUI_link);
		var sagePointer = document.createElement('p');
		var sagePointer_link = document.createElement('a');
		sagePointer_link.textContent = "SAGE Pointer";
		if (json_cfg.public_host)
			sagePointer_link.href = "https://" + json_cfg.public_host + https_port + "/sagePointer.html";
		else
			sagePointer_link.href = "https://" + json_cfg.host + https_port + "/sagePointer.html";
		sagePointer_link.target = "_blank";
		sagePointer.appendChild(sagePointer_link);
		
		userInteraction.appendChild(sageUI);
		userInteraction.appendChild(sagePointer);
		
		// Audio
		var audioManager = document.createElement('p');
		var audioManager_link = document.createElement('a');
		audioManager_link.textContent = "Audio Manager";
		if (json_cfg.public_host)
			audioManager_link.href = "https://" + json_cfg.public_host + https_port + "/audioManager.html";
		else
			audioManager_link.href = "https://" + json_cfg.host + https_port + "/audioManager.html";
		audioManager_link.target = "_blank";
		audioManager.appendChild(audioManager_link);
		
		audio.appendChild(audioManager);
		
		// Display
		for(var i=0; i<json_cfg.displays.length; i++){
			var displayClient = document.createElement('p');
			var displayClient_link = document.createElement('a');
			displayClient_link.textContent = "Display (client " + i.toString() + ")";
			if (json_cfg.public_host)
				displayClient_link.href = "https://" + json_cfg.public_host + https_port + "/?clientID=" + i.toString();
			else
				displayClient_link.href = "https://" + json_cfg.host + https_port + "/?clientID=" + i.toString();
			displayClient_link.target = "_blank";
			displayClient.appendChild(displayClient_link);
		
			display.appendChild(displayClient);
		}
		// Add the overview client
		var i = -1;
		var displayClient = document.createElement('p');
		var displayClient_link = document.createElement('a');
		displayClient_link.textContent = "Overview display (press 'f' to switch view and trackpad/wheel to navigate)";
		if (json_cfg.public_host)
			displayClient_link.href = "https://" + json_cfg.public_host + https_port + "/?clientID=" + i.toString();
		else
			displayClient_link.href = "https://" + json_cfg.host + https_port + "/?clientID=" + i.toString();
		displayClient_link.target = "_blank";
		displayClient.appendChild(displayClient_link);
		display.appendChild(displayClient);

		// Info
		var aul = document.createElement('ul');
		if (json_cfg.public_host) {
			var info1 = document.createElement('li');
			info1.innerHTML = "Host (public): " + json_cfg.public_host;
			aul.appendChild(info1);
		}
		var info2 = document.createElement('li');
		info2.innerHTML = "Host: " + json_cfg.host;
		aul.appendChild(info2);
		var info3 = document.createElement('li');
		info3.innerHTML = "Resolution: " + json_cfg.totalWidth + "x" +  json_cfg.totalHeight + " pixels";
		aul.appendChild(info3);
		var info4 = document.createElement('li');
		info4.innerHTML  = "Tiles: " + json_cfg.layout.columns + " by " + json_cfg.layout.rows;
		info4.innerHTML += " (" + json_cfg.resolution.width + "x" + json_cfg.resolution.height +")";
		aul.appendChild(info4);
		information.appendChild(aul);

		// Remote sites
		var remotes = document.createElement('ol');
		var rs, lrs;
		for (var i = 0; i < json_cfg.remote_sites.length; i++) {
			rs  = document.createElement('li');
			lrs = document.createElement('a');
			lrs.textContent = json_cfg.remote_sites[i].name;
			//lrs.href = "http://" + json_cfg.remote_sites[i].host + ":" + json_cfg.remote_sites[i].port;
			lrs.href = "http://" + json_cfg.remote_sites[i].host; // assumes on port 80
			lrs.target = "_blank";
			rs.appendChild(lrs);
			remotes.appendChild(rs);
		};
		remotesites.appendChild(remotes);

	}
</script>

<link rel="stylesheet" type="text/css" href="style.css" media="screen" />

</head>

<body onload="init()">

	<header>
		<h1>SAGE2 Index</h1>
		<p>access all the SAGE2 clients from one place</p>
	</header>

	<main>

		<section id="userInteraction" class="siteType">
			<h2>User Interaction Pages</h2>
		</section>

		<section id="audio" class="siteType">
			<h2>Audio Pages</h2>
		</section>

		<section id="display" class="siteType">
			<h2>Display Pages</h2>
		</section>

		<section id="remotesites" class="siteType">
			<h2>Remote Sites</h2>
		</section>

		<section id="information" class="siteType">
			<h2>Configuration</h2>
		</section>


	</main>

	<footer>
	  <ul>
	    <li>University of Illinois at Chicago's Electronic Visualization Laboratory (EVL)
		<li>University of Hawai'i at Manoa's Laboratory for Advanced Visualization and Applications (LAVA)
		<li style="font-style:italic;">SAGE2 and SAGE are trademarks of the University of Illinois Board of Trustees.
		<li style="font-style:italic;">Major funding for SAGE2 and SAGE is provided by National Science Foundation award ACI-1339772.
	  </ul>
	</footer>

</body>
</html>

